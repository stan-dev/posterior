<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- upstream: inst/BS5/templates/head.html; pkgdown-version: 2.1.3, fe04924 --><!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 --><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Random variables of arbitrary dimension — rvar • posterior</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@4.0.0/tex-mml-chtml.js" integrity="sha256-qoRlVrS5NAnXSSSiMfFXwK8C9obG11Iybe4h2+bQYR4=" crossorigin="anonymous">
  </script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_3-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome 7.0.1 for Bluesky icon --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" referrerpolicy="no-referrer"><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Random variables of arbitrary dimension — rvar"><meta name="description" content="Random variables backed by arrays of arbitrary dimension"><meta property="og:description" content="Random variables backed by arrays of arbitrary dimension"><meta property="og:image" content="https://mc-stan.org/posterior/logo.svg"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <!-- upstream: inst/BS5/templates/navbar.html; pkgdown-version: 2.1.3, fe04924 -->
<!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 -->
<nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">


    <a class="navbar-brand me-2" href="../index.html">
      <!-- Add Stan logo -->
      <picture><source type="image/svg+xml" srcset="../logo.svg"><img src="../logo.png" class="stan-logo" alt="Stan blue hex logo"></source></picture>
      posterior
    </a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.6.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://mc-stan.org/rstan">rstan</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/cmdstanr">cmdstanr</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstanarm">rstanarm</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/bayesplot">bayesplot</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/shinystan">shinystan</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/loo">loo</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/projpred">projpred</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstantools">rstantools</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mc-stan.org">Stan</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/mcmc_stan"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stan-dev/posterior"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://discourse.mc-stan.org/"><span class="fa fa-users"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Random variables of arbitrary dimension</h1>
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/posterior/blob/master/R/rvar-.R" class="external-link"><code>R/rvar-.R</code></a></small>
      <div class="d-none name"><code>rvar.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Random variables backed by arrays of arbitrary dimension</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rvar</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nchains <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  with_chains <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>(multiple options) The object to convert to an <code>rvar</code>:</p><ul><li><p>A vector of draws from a distribution.</p></li>
<li><p>An array where the first dimension represents draws from a distribution.
The resulting <code>rvar</code> will have dimension <code>dim(x)[-1]</code>; that is,
everything except the first dimension is used for the shape of the
variable, and the first dimension is used to index draws from the
distribution (see <strong>Examples</strong>). Optionally,
if <code>with_chains == TRUE</code>, the first dimension indexes the iteration and the
second dimension indexes the chain (see <code>with_chains</code>).</p></li>
<li><p>An <code>rvar</code>.</p></li>
</ul></dd>


<dt id="arg-dim">dim<a class="anchor" aria-label="anchor" href="#arg-dim"></a></dt>
<dd><p>(integer vector) One or more integers giving the maximal indices
in each dimension to override the dimensions of the <code>rvar</code> to be created
(see <code><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim()</a></code>). If <code>NULL</code> (the default), <code>dim</code> is determined by the input.
<strong>NOTE:</strong> This argument controls the dimensions of the <code>rvar</code>, not the
underlying array, so you cannot change the number of draws using this
argument.</p></dd>


<dt id="arg-dimnames">dimnames<a class="anchor" aria-label="anchor" href="#arg-dimnames"></a></dt>
<dd><p>(list) Character vectors giving the names in each dimension
to override the names of the dimensions of the <code>rvar</code> to be created (see
<code><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames()</a></code>). If <code>NULL</code> (the default), this is determined by the input.
<strong>NOTE:</strong> This argument controls the names of the dimensions of the
<code>rvar</code>, not the underlying array.</p></dd>


<dt id="arg-nchains">nchains<a class="anchor" aria-label="anchor" href="#arg-nchains"></a></dt>
<dd><p>(positive integer) The number of chains. The if <code>NULL</code> (the default),
<code>1</code> is used unless <code>x</code> is already an <code>rvar</code>, in which case the number of
chains it has is used.</p></dd>


<dt id="arg-with-chains">with_chains<a class="anchor" aria-label="anchor" href="#arg-with-chains"></a></dt>
<dd><p>(logical) Does <code>x</code> include a dimension for chains?
If <code>FALSE</code> (the default), chains are not included, the first dimension of
the input array should index draws, and the <code>nchains</code> argument can be
used to determine the number of chains. If <code>TRUE</code>, the <code>nchains</code> argument
is ignored and the second dimension of <code>x</code> is used to index chains.
Internally, the array will be converted to a format without the chain index.
Ignored when <code>x</code> is already an <code>rvar</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"rvar"</code> representing a random variable.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>"rvar"</code> class internally represents random variables as arrays of arbitrary
dimension, where the first dimension is used to index draws from the distribution.
Most mathematical operators and functions are supported, including efficient matrix
multiplication and vector and array-style indexing. The intent is that an <code>rvar</code>
works as closely as possible to how a base vector/matrix/array does, with a few
differences:</p><ul><li><p>The default behavior when subsetting is not to drop extra dimensions (i.e.
the default <code>drop</code> argument for <code>[</code> is <code>FALSE</code>, not <code>TRUE</code>).</p></li>
<li><p>Rather than base R-style recycling, <code>rvar</code>s use a limited form of broadcasting:
if an operation is being performed on two vectors with different size of the same
dimension, the smaller vector will be recycled up to the size of the larger one
along that dimension so long as it has size 1.</p></li>
</ul><p>For functions that expect base numeric arrays and for which <code>rvar</code>s cannot be
used directly as arguments, you can use <code><a href="rfun.html">rfun()</a></code> or <code><a href="rdo.html">rdo()</a></code> to translate your
code into code that executes across draws from one or more random variables
and returns a random variable as output. Typically <code><a href="rdo.html">rdo()</a></code> offers the most
straightforward translation.</p>
<p>As <code><a href="rfun.html">rfun()</a></code> and <code><a href="rdo.html">rdo()</a></code> incur some performance cost, you can also operate directly
on the underlying array using the <code><a href="draws_of.html">draws_of()</a></code> function. To re-use existing
random number generator functions to efficiently create <code>rvar</code>s, use <code><a href="rvar_rng.html">rvar_rng()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="as_rvar.html">as_rvar()</a></code> to convert objects to <code>rvar</code>s. See <code><a href="rdo.html">rdo()</a></code>, <code><a href="rfun.html">rfun()</a></code>, and
<code><a href="rvar_rng.html">rvar_rng()</a></code> for higher-level interfaces for creating <code>rvar</code>s.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To create a "scalar" `rvar`, pass a one-dimensional array or a vector</span></span></span>
<span class="r-in"><span><span class="co"># whose length (here `4000`) is the desired number of draws:</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">rvar</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4000</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rvar&lt;4000&gt;[1] <span style="color: #949494;">mean ± sd:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 ± 1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create random vectors by adding an additional dimension:</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">4</span>   <span class="co"># length of output vector</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">rvar</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4000</span> <span class="op">*</span> <span class="va">n</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, each <span class="op">=</span> <span class="fl">4000</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4000</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rvar&lt;4000&gt;[4] <span style="color: #949494;">mean ± sd:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 ± 0.99  2 ± 0.99  3 ± 1.00  4 ± 1.02 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a random matrix:</span></span></span>
<span class="r-in"><span><span class="va">rows</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">rvar</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4000</span> <span class="op">*</span> <span class="va">rows</span> <span class="op">*</span> <span class="va">cols</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4000</span>, <span class="va">rows</span>, <span class="va">cols</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rvar&lt;4000&gt;[4,3] <span style="color: #949494;">mean ± sd:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]         [,2]         [,3]        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.00 ± 0.98  1.00 ± 1.00  0.97 ± 1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 1.00 ± 1.01  1.01 ± 1.02  0.99 ± 0.99 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 1.02 ± 1.01  0.99 ± 1.00  1.00 ± 0.99 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 1.01 ± 1.01  1.02 ± 1.00  1.00 ± 1.01 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If the input sample comes from multiple chains, we can indicate that using the</span></span></span>
<span class="r-in"><span><span class="co"># nchains argument (here, 1000 draws each from 4 chains):</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">rvar</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4000</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, nchains <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rvar&lt;1000,4&gt;[1] <span style="color: #949494;">mean ± sd:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.97 ± 1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or if the input sample has chain information as its second dimension, we can</span></span></span>
<span class="r-in"><span><span class="co"># use with_chains to create the rvar</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">rvar</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4000</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>, with_chains <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rvar&lt;1000,4&gt;[1] <span style="color: #949494;">mean ± sd:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 ± 1 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul-Christian Bürkner, Jonah Gabry, Matthew Kay, Aki Vehtari.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

