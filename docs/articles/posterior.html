<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The posterior R package • posterior</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The posterior R package">
<meta property="og:description" content="posterior">
<meta property="og:image" content="https://mc-stan.org/posterior/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">posterior</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://mc-stan.org/rstan" class="external-link">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/cmdstanr" class="external-link">cmdstanr</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstanarm" class="external-link">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/bayesplot" class="external-link">bayesplot</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan" class="external-link">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo" class="external-link">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/projpred" class="external-link">projpred</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools" class="external-link">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mc-stan.org" class="external-link">Stan</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/mcmc_stan" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/posterior" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The posterior R package</h1>
                        <h4 data-toc-skip class="author">Paul Bürkner,
Jonah Gabry, Matthew Kay, and Aki Vehtari</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/posterior/blob/HEAD/vignettes/posterior.Rmd" class="external-link"><code>vignettes/posterior.Rmd</code></a></small>
      <div class="hidden name"><code>posterior.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The posterior R package is intended to provide useful tools for both
users and developers of packages for fitting Bayesian models or working
with output from Bayesian models. The primary goals of the package are
to:</p>
<ul>
<li>Efficiently convert between many different useful formats of draws
(samples) from posterior or prior distributions.</li>
<li>Provide consistent methods for operations commonly performed on
draws, for example, subsetting, binding, or mutating draws.</li>
<li>Provide various summaries of draws in convenient formats.</li>
<li>Provide lightweight implementations of state of the art posterior
inference diagnostics.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the latest official release version via</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p>or the latest development version from GitHub via</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"stan-dev/posterior"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mc-stan.org/posterior/">"posterior"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## This is posterior version 1.6.0</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'posterior'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     mad, sd, var</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     %in%, match</span></span></code></pre>
<p>To demonstrate how to work with the posterior package, throughout the
rest of this vignette we will use example posterior draws obtained from
the eight schools hierarchical meta-analysis model described in Gelman
et al. (2013). The variables are an estimate per school
(<code>theta[1]</code> through <code>theta[8]</code>) as well as an
overall mean (<code>mu</code>) and standard deviation across schools
(<code>tau</code>).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eight_schools_array</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_draws.html">example_draws</a></span><span class="op">(</span><span class="st">"eight_schools"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">eight_schools_array</span>, max_variables <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A draws_array: 100 iterations, 4 chains, and 10 variables</span></span>
<span><span class="co">## , , variable = mu</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          chain</span></span>
<span><span class="co">## iteration   1    2     3   4</span></span>
<span><span class="co">##         1 2.0  3.0  1.79 6.5</span></span>
<span><span class="co">##         2 1.5  8.2  5.99 9.1</span></span>
<span><span class="co">##         3 5.8 -1.2  2.56 0.2</span></span>
<span><span class="co">##         4 6.8 10.9  2.79 3.7</span></span>
<span><span class="co">##         5 1.8  9.8 -0.03 5.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , variable = tau</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          chain</span></span>
<span><span class="co">## iteration   1    2    3   4</span></span>
<span><span class="co">##         1 2.8 2.80  8.7 3.8</span></span>
<span><span class="co">##         2 7.0 2.76  2.9 6.8</span></span>
<span><span class="co">##         3 9.7 0.57  8.4 5.3</span></span>
<span><span class="co">##         4 4.8 2.45  4.4 1.6</span></span>
<span><span class="co">##         5 2.8 2.80 11.0 3.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , variable = theta[1]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          chain</span></span>
<span><span class="co">## iteration     1     2    3     4</span></span>
<span><span class="co">##         1  3.96  6.26 13.3  5.78</span></span>
<span><span class="co">##         2  0.12  9.32  6.3  2.09</span></span>
<span><span class="co">##         3 21.25 -0.97 10.6 15.72</span></span>
<span><span class="co">##         4 14.70 12.45  5.4  2.69</span></span>
<span><span class="co">##         5  5.96  9.75  8.2 -0.91</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # ... with 95 more iterations, and 7 more variables</span></span></code></pre>
<p>The structure of this object is explained in the next section.</p>
</div>
<div class="section level2">
<h2 id="draws-formats">Draws formats<a class="anchor" aria-label="anchor" href="#draws-formats"></a>
</h2>
<div class="section level3">
<h3 id="available-formats">Available formats<a class="anchor" aria-label="anchor" href="#available-formats"></a>
</h3>
<p>Because different formats are preferable in different situations,
posterior supports multiple formats and easy conversion between them.
The currently supported formats are:</p>
<ul>
<li>
<code>draws_array</code>: An iterations by chains by variables
array.</li>
<li>
<code>draws_matrix</code>: A draws (iterations x chains) by
variables array.</li>
<li>
<code>draws_df</code>: A draws by variables data frame with addition
meta columns <code>.chain</code>, <code>.iteration</code>,
<code>.draw</code>.</li>
<li>
<code>draws_list</code>: A list with one sublist per chain. Each
sublist is a named list with one vector of iterations per variable.</li>
<li>
<code>draws_rvars</code>: A list of random variable
<code>rvar</code> objects, one per variable. See
<code><a href="../articles/rvar.html">vignette("rvar")</a></code> for an introduction to this new data
type.</li>
</ul>
<p>These formats are essentially base R object classes and can be used
as such. For example, a <code>draws_matrix</code> object is just a
<code>matrix</code> with a little more consistency (e.g., no dropping of
dimensions with one level when indexing) and additional methods. The
exception to this is the <code>draws_rvars</code> format, which contains
<code>rvar</code> objects that behave somewhat like arrays but are
really a unique data type. See the separate vignette on the
<code>rvar</code> and <code>draws_rvars</code> data types for
details.</p>
<p>The draws for our example come as a <code>draws_array</code> object
with 100 iterations, 4 chains, and 10 variables:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">eight_schools_array</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  'draws_array' num [1:100, 1:4, 1:10] 2.01 1.46 5.81 6.85 1.81 ...</span></span>
<span><span class="co">##  - attr(*, "dimnames")=List of 3</span></span>
<span><span class="co">##   ..$ iteration: chr [1:100] "1" "2" "3" "4" ...</span></span>
<span><span class="co">##   ..$ chain    : chr [1:4] "1" "2" "3" "4"</span></span>
<span><span class="co">##   ..$ variable : chr [1:10] "mu" "tau" "theta[1]" "theta[2]" ...</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="converting-between-formats">Converting between formats<a class="anchor" aria-label="anchor" href="#converting-between-formats"></a>
</h3>
<p>Each of the formats has a method <code>as_draws_&lt;format&gt;</code>
(e.g., <code><a href="../reference/draws_list.html">as_draws_list()</a></code>) for creating an object of the class
from any of the other formats. As a demonstration we can convert the
example <code>draws_array</code> to a <code>draws_df</code>, a data
frame with additional meta information. To convert to a
<code>draws_df</code> we use <code><a href="../reference/draws_df.html">as_draws_df()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eight_schools_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws_df.html">as_draws_df</a></span><span class="op">(</span><span class="va">eight_schools_array</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">eight_schools_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## draws_df [400 × 13] (S3: draws_df/draws/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##  $ mu        : num [1:400] 2.01 1.46 5.81 6.85 1.81 ...</span></span>
<span><span class="co">##  $ tau       : num [1:400] 2.77 6.98 9.68 4.79 2.85 ...</span></span>
<span><span class="co">##  $ theta[1]  : num [1:400] 3.962 0.124 21.251 14.7 5.96 ...</span></span>
<span><span class="co">##  $ theta[2]  : num [1:400] 0.271 -0.069 14.931 8.586 1.156 ...</span></span>
<span><span class="co">##  $ theta[3]  : num [1:400] -0.743 0.952 1.829 2.675 3.109 ...</span></span>
<span><span class="co">##  $ theta[4]  : num [1:400] 2.1 7.28 1.38 4.39 1.99 ...</span></span>
<span><span class="co">##  $ theta[5]  : num [1:400] 0.923 -0.062 0.531 4.758 0.769 ...</span></span>
<span><span class="co">##  $ theta[6]  : num [1:400] 1.65 11.26 7.16 8.1 4.66 ...</span></span>
<span><span class="co">##  $ theta[7]  : num [1:400] 3.32 9.62 14.8 9.49 1.21 ...</span></span>
<span><span class="co">##  $ theta[8]  : num [1:400] 4.85 -8.64 -1.74 5.28 -4.54 ...</span></span>
<span><span class="co">##  $ .chain    : int [1:400] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ .iteration: int [1:400] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##  $ .draw     : int [1:400] 1 2 3 4 5 6 7 8 9 10 ...</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">eight_schools_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A draws_df: 100 iterations, 4 chains, and 10 variables</span></span>
<span><span class="co">##      mu tau theta[1] theta[2] theta[3] theta[4] theta[5] theta[6]</span></span>
<span><span class="co">## 1  2.01 2.8     3.96    0.271    -0.74      2.1    0.923      1.7</span></span>
<span><span class="co">## 2  1.46 7.0     0.12   -0.069     0.95      7.3   -0.062     11.3</span></span>
<span><span class="co">## 3  5.81 9.7    21.25   14.931     1.83      1.4    0.531      7.2</span></span>
<span><span class="co">## 4  6.85 4.8    14.70    8.586     2.67      4.4    4.758      8.1</span></span>
<span><span class="co">## 5  1.81 2.8     5.96    1.156     3.11      2.0    0.769      4.7</span></span>
<span><span class="co">## 6  3.84 4.1     5.76    9.909    -1.00      5.3    5.889     -1.7</span></span>
<span><span class="co">## 7  5.47 4.0     4.03    4.151    10.15      6.6    3.741     -2.2</span></span>
<span><span class="co">## 8  1.20 1.5    -0.28    1.846     0.47      4.3    1.467      3.3</span></span>
<span><span class="co">## 9  0.15 3.9     1.81    0.661     0.86      4.5   -1.025      1.1</span></span>
<span><span class="co">## 10 7.17 1.8     6.08    8.102     7.68      5.6    7.106      8.5</span></span>
<span><span class="co">## # ... with 390 more draws, and 2 more variables</span></span>
<span><span class="co">## # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="converting-regular-r-objects-to-draws-formats">Converting regular R objects to <code>draws</code> formats<a class="anchor" aria-label="anchor" href="#converting-regular-r-objects-to-draws-formats"></a>
</h3>
<p>The example draws already come in a format natively supported by
posterior, but we can of course also import the draws from other sources
like common base R objects.</p>
<div class="section level4">
<h4 id="example-create-draws_matrix-from-a-matrix">Example: create draws_matrix from a matrix<a class="anchor" aria-label="anchor" href="#example-create-draws_matrix-from-a-matrix"></a>
</h4>
<p>In addition to converting other <code>draws</code> objects to the
<code>draws_matrix</code> format, the <code><a href="../reference/draws_matrix.html">as_draws_matrix()</a></code>
function will convert a regular matrix to a
<code>draws_matrix</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws_matrix.html">as_draws_matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A draws_matrix: 10 iterations, 1 chains, and 5 variables</span></span>
<span><span class="co">##     variable</span></span>
<span><span class="co">## draw    V1     V2    V3    V4     V5</span></span>
<span><span class="co">##   1  -1.14 -1.386  0.54 -0.83  0.700</span></span>
<span><span class="co">##   2  -1.52  2.124 -0.35  0.64  1.078</span></span>
<span><span class="co">##   3  -2.01 -1.062  0.40  0.94 -0.071</span></span>
<span><span class="co">##   4   0.31 -0.032  1.69  0.55 -0.071</span></span>
<span><span class="co">##   5  -0.63 -1.580  0.83  0.69 -0.870</span></span>
<span><span class="co">##   6   0.12  0.687  1.76 -0.25 -0.448</span></span>
<span><span class="co">##   7  -0.25  0.278  0.79  0.68  2.251</span></span>
<span><span class="co">##   8   0.98  0.932 -1.02  0.45  2.170</span></span>
<span><span class="co">##   9  -0.30 -0.384 -0.12  1.34  0.434</span></span>
<span><span class="co">##   10 -0.38 -0.872 -2.81 -0.36 -0.379</span></span></code></pre>
<p>Because the matrix was converted to a <code>draws_matrix</code>, all
of the methods for working with <code>draws</code> objects described in
subsequent sections of this vignette will now be available.</p>
<p>Instead of <code><a href="../reference/draws_matrix.html">as_draws_matrix()</a></code> we also could have just
used <code><a href="../reference/draws.html">as_draws()</a></code>, which attempts to find the closest
available format to the input object. In this case the result would be a
<code>draws_matrix</code> object either way.</p>
</div>
<div class="section level4">
<h4 id="example-create-draws_matrix-from-multiple-vectors">Example: create draws_matrix from multiple vectors<a class="anchor" aria-label="anchor" href="#example-create-draws_matrix-from-multiple-vectors"></a>
</h4>
<p>In addition to the <code><a href="../reference/draws_matrix.html">as_draws_matrix()</a></code> converter function
there is also a <code><a href="../reference/draws_matrix.html">draws_matrix()</a></code> constructor function that
can be used to create draws matrix from multiple vectors.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws_matrix.html">draws_matrix</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>, beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A draws_matrix: 50 iterations, 1 chains, and 2 variables</span></span>
<span><span class="co">##     variable</span></span>
<span><span class="co">## draw  alpha   beta</span></span>
<span><span class="co">##   1  -0.044 -0.885</span></span>
<span><span class="co">##   2  -1.048  1.247</span></span>
<span><span class="co">##   3   0.983  0.725</span></span>
<span><span class="co">##   4   1.390  1.201</span></span>
<span><span class="co">##   5  -1.002 -0.693</span></span>
<span><span class="co">##   6   0.247 -1.470</span></span>
<span><span class="co">##   7   1.265 -0.074</span></span>
<span><span class="co">##   8   0.113 -0.132</span></span>
<span><span class="co">##   9  -0.094  0.310</span></span>
<span><span class="co">##   10 -0.794 -0.014</span></span>
<span><span class="co">## # ... with 40 more draws</span></span></code></pre>
<p>Analogous functions exist for the other draws formats and are used
similarly.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="manipulating-draws-objects">Manipulating <code>draws</code> objects<a class="anchor" aria-label="anchor" href="#manipulating-draws-objects"></a>
</h2>
<p>The posterior package provides many methods for manipulating draws
objects in useful ways. In this section we demonstrate several of the
most commonly used methods. These methods, like the other methods in
posterior, are available for every supported draws format.</p>
<div class="section level3">
<h3 id="subsetting">Subsetting<a class="anchor" aria-label="anchor" href="#subsetting"></a>
</h3>
<p>Subsetting <code>draws</code> objects can be done according to
various aspects of the draws (iterations, chains, or variables). The
posterior package provides a convenient interface for this purpose via
<code><a href="../reference/subset_draws.html">subset_draws()</a></code>. For example, here is the code to extract
the first five iterations of the first two chains of the variable
<code>mu</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sub_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_draws.html">subset_draws</a></span><span class="op">(</span><span class="va">eight_schools_df</span>, variable <span class="op">=</span> <span class="st">"mu"</span>, chain <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, iteration <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sub_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## draws_df [10 × 4] (S3: draws_df/draws/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##  $ mu        : num [1:10] 2.01 1.46 5.81 6.85 1.81 ...</span></span>
<span><span class="co">##  $ .chain    : int [1:10] 1 1 1 1 1 2 2 2 2 2</span></span>
<span><span class="co">##  $ .iteration: int [1:10] 1 2 3 4 5 1 2 3 4 5</span></span>
<span><span class="co">##  $ .draw     : int [1:10] 1 2 3 4 5 6 7 8 9 10</span></span></code></pre>
<p>The same call to <code><a href="../reference/subset_draws.html">subset_draws()</a></code> can be used regardless
of the draws format. For example, here is the same code except replacing
the <code>draws_df</code> object with the <code>draws_array</code>
object.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sub_arr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_draws.html">subset_draws</a></span><span class="op">(</span><span class="va">eight_schools_array</span>, variable <span class="op">=</span> <span class="st">"mu"</span>, chain <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, iteration <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sub_arr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  'draws_array' num [1:5, 1:2, 1] 2.01 1.46 5.81 6.85 1.81 ...</span></span>
<span><span class="co">##  - attr(*, "dimnames")=List of 3</span></span>
<span><span class="co">##   ..$ iteration: chr [1:5] "1" "2" "3" "4" ...</span></span>
<span><span class="co">##   ..$ chain    : chr [1:2] "1" "2"</span></span>
<span><span class="co">##   ..$ variable : chr "mu"</span></span></code></pre>
<p>We can check that these two calls to <code><a href="../reference/subset_draws.html">subset_draws()</a></code> (the
first with the data frame, the second with the array) produce the same
result.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">sub_df</span>, <span class="fu"><a href="../reference/draws_df.html">as_draws_df</a></span><span class="op">(</span><span class="va">sub_arr</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="../reference/draws_array.html">as_draws_array</a></span><span class="op">(</span><span class="va">sub_df</span><span class="op">)</span>, <span class="va">sub_arr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## [1] TRUE</span></span></code></pre>
<p>It is also possible to use standard R subsetting syntax with
<code>draws</code> objects. The following is equivalent to the use of
<code><a href="../reference/subset_draws.html">subset_draws()</a></code> with the array above.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eight_schools_array</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="st">"mu"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## # A draws_array: 5 iterations, 2 chains, and 1 variables</span></span>
<span><span class="co">## , , variable = mu</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          chain</span></span>
<span><span class="co">## iteration   1    2</span></span>
<span><span class="co">##         1 2.0  3.0</span></span>
<span><span class="co">##         2 1.5  8.2</span></span>
<span><span class="co">##         3 5.8 -1.2</span></span>
<span><span class="co">##         4 6.8 10.9</span></span>
<span><span class="co">##         5 1.8  9.8</span></span></code></pre>
<p>The major difference between how posterior behaves when indexing and
how base R behaves is that posterior will <em>not</em> drop dimensions
with only one level. That is, even though there is only one variable
left after subsetting, the result of the subsetting above is still a
<code>draws_array</code> and not a <code>draws_matrix</code>.</p>
</div>
<div class="section level3">
<h3 id="mutating-transformations-of-variables">Mutating (transformations of variables)<a class="anchor" aria-label="anchor" href="#mutating-transformations-of-variables"></a>
</h3>
<p>The magic of having obtained draws from the joint posterior (or
prior) distribution of a set of variables is that these draws can also
be used to obtain draws from any other variable that is a function of
the original variables. That is, if we are interested in the posterior
distribution of, say, <code>phi = (mu + tau)^2</code> all we have to do
is to perform the transformation for each of the individual draws to
obtain draws from the posterior distribution of the transformed
variable. This procedure is handled by
<code><a href="../reference/mutate_variables.html">mutate_variables()</a></code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mutate_variables.html">mutate_variables</a></span><span class="op">(</span><span class="va">eight_schools_df</span>, phi <span class="op">=</span> <span class="op">(</span><span class="va">mu</span> <span class="op">+</span> <span class="va">tau</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_draws.html">subset_draws</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mu"</span>, <span class="st">"tau"</span>, <span class="st">"phi"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A draws_df: 100 iterations, 4 chains, and 3 variables</span></span>
<span><span class="co">##      mu tau   phi</span></span>
<span><span class="co">## 1  2.01 2.8  22.8</span></span>
<span><span class="co">## 2  1.46 7.0  71.2</span></span>
<span><span class="co">## 3  5.81 9.7 240.0</span></span>
<span><span class="co">## 4  6.85 4.8 135.4</span></span>
<span><span class="co">## 5  1.81 2.8  21.7</span></span>
<span><span class="co">## 6  3.84 4.1  62.8</span></span>
<span><span class="co">## 7  5.47 4.0  88.8</span></span>
<span><span class="co">## 8  1.20 1.5   7.1</span></span>
<span><span class="co">## 9  0.15 3.9  16.6</span></span>
<span><span class="co">## 10 7.17 1.8  79.9</span></span>
<span><span class="co">## # ... with 390 more draws</span></span>
<span><span class="co">## # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="renaming">Renaming<a class="anchor" aria-label="anchor" href="#renaming"></a>
</h3>
<p>To rename variables use <code><a href="../reference/rename_variables.html">rename_variables()</a></code>. Here we
rename the scalar <code>mu</code> to <code>mean</code> and the vector
<code>theta</code> to <code>alpha</code>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># mu is a scalar, theta is a vector</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rename_variables.html">rename_variables</a></span><span class="op">(</span><span class="va">eight_schools_df</span>, mean <span class="op">=</span> <span class="va">mu</span>, alpha <span class="op">=</span> <span class="va">theta</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/variables.html">variables</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "mean"     "tau"      "alpha[1]" "alpha[2]" "alpha[3]" "alpha[4]"</span></span>
<span><span class="co">##  [7] "alpha[5]" "alpha[6]" "alpha[7]" "alpha[8]"</span></span></code></pre>
<p>In the call to <code><a href="../reference/rename_variables.html">rename_variables()</a></code> above, <code>mu</code>
and <code>theta</code> can be quoted or unquoted.</p>
<p>It is also possible to rename individual elements of non-scalar
parameters, for example we can rename just the first element of
<code>alpha</code>:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rename_variables.html">rename_variables</a></span><span class="op">(</span><span class="va">x</span>, a1 <span class="op">=</span> <span class="va">`alpha[1]`</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/variables.html">variables</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "mean"     "tau"      "a1"       "alpha[2]" "alpha[3]" "alpha[4]"</span></span>
<span><span class="co">##  [7] "alpha[5]" "alpha[6]" "alpha[7]" "alpha[8]"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="binding">Binding<a class="anchor" aria-label="anchor" href="#binding"></a>
</h3>
<p>The <code><a href="../reference/bind_draws.html">bind_draws()</a></code> method can be used to combine
<code>draws</code> objects along different dimensions. As an example,
suppose we have several different <code>draws_matrix</code> objects:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws_matrix.html">draws_matrix</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws_matrix.html">draws_matrix</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws_matrix.html">draws_matrix</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can bind <code>x1</code> and <code>x3</code> together along the
<code>'variable'</code> dimension to get a single
<code>draws_matrix</code> with the variables from both <code>x1</code>
and <code>x3</code>:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind_draws.html">bind_draws</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x3</span>, along <span class="op">=</span> <span class="st">"variable"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A draws_matrix: 5 iterations, 1 chains, and 3 variables</span></span>
<span><span class="co">##     variable</span></span>
<span><span class="co">## draw  alpha   beta theta</span></span>
<span><span class="co">##    1  0.793 -0.073  0.22</span></span>
<span><span class="co">##    2  0.483  0.267  0.19</span></span>
<span><span class="co">##    3  0.331  0.238  6.60</span></span>
<span><span class="co">##    4 -0.837  1.301  0.47</span></span>
<span><span class="co">##    5  0.066  0.722  1.33</span></span></code></pre>
<p>Because <code>x1</code> and <code>x2</code> have the same variables,
we can bind them along the <code>'draw'</code> dimension to create a
single <code>draws_matrix</code> with more draws:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind_draws.html">bind_draws</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, along <span class="op">=</span> <span class="st">"draw"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A draws_matrix: 10 iterations, 1 chains, and 2 variables</span></span>
<span><span class="co">##     variable</span></span>
<span><span class="co">## draw  alpha   beta</span></span>
<span><span class="co">##   1   0.793 -0.073</span></span>
<span><span class="co">##   2   0.483  0.267</span></span>
<span><span class="co">##   3   0.331  0.238</span></span>
<span><span class="co">##   4  -0.837  1.301</span></span>
<span><span class="co">##   5   0.066  0.722</span></span>
<span><span class="co">##   6   1.374  1.284</span></span>
<span><span class="co">##   7  -0.061 -0.212</span></span>
<span><span class="co">##   8  -0.386 -0.052</span></span>
<span><span class="co">##   9  -1.356  0.061</span></span>
<span><span class="co">##   10  0.627 -0.815</span></span></code></pre>
<p>As with all posterior methods, <code><a href="../reference/bind_draws.html">bind_draws()</a></code> can be used
with all draws formats and depending on the format different dimensions
are available to bind on. For example, we can bind
<code>draws_array</code> objects together by <code>iteration</code>,
<code>chain</code>, or <code>variable</code>, but a 2-D
<code>draws_matrix</code> with the chains combined can only by bound by
<code>draw</code> and <code>variable</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="summaries-and-diagnostics">Summaries and diagnostics<a class="anchor" aria-label="anchor" href="#summaries-and-diagnostics"></a>
</h2>
<div class="section level3">
<h3 id="summarise_draws-basic-usage">summarise_draws() basic usage<a class="anchor" aria-label="anchor" href="#summarise_draws-basic-usage"></a>
</h3>
<p>Computing summaries of posterior or prior draws and convergence
diagnostics for posterior draws are some of the most common tasks when
working with Bayesian models fit using Markov Chain Monte Carlo (MCMC)
methods. The posterior package provides a flexible interface for this
purpose via <code><a href="../reference/draws_summary.html">summarise_draws()</a></code> (or
<code><a href="../reference/draws_summary.html">summarize_draws()</a></code>), which can be passed any of the formats
supported by the package.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># summarise_draws or summarize_draws</span></span>
<span><span class="fu"><a href="../reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">eight_schools_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 10</span></span></span>
<span><span class="co">##    variable  mean median    sd   mad      q5   q95  rhat ess_bulk ess_tail</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> mu        4.18   4.16  3.40  3.57  -<span style="color: #BB0000;">0.854</span>  9.39  1.02     558.     322.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> tau       4.16   3.07  3.58  2.89   0.309 11.0   1.01     246.     202.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> theta[1]  6.75   5.97  6.30  4.87  -<span style="color: #BB0000;">1.23</span>  18.9   1.01     400.     254.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> theta[2]  5.25   5.13  4.63  4.25  -<span style="color: #BB0000;">1.97</span>  12.5   1.02     564.     372.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> theta[3]  3.04   3.99  6.80  4.94 -<span style="color: #BB0000;">10.3</span>   11.9   1.01     312.     205.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> theta[4]  4.86   4.99  4.92  4.51  -<span style="color: #BB0000;">3.57</span>  12.2   1.02     695.     252.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> theta[5]  3.22   3.72  5.08  4.38  -<span style="color: #BB0000;">5.93</span>  10.8   1.01     523.     306.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> theta[6]  3.99   4.14  5.16  4.81  -<span style="color: #BB0000;">4.32</span>  11.5   1.02     548.     205.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> theta[7]  6.50   5.90  5.26  4.54  -<span style="color: #BB0000;">1.19</span>  15.4   1.00     434.     308.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> theta[8]  4.57   4.64  5.25  4.89  -<span style="color: #BB0000;">3.79</span>  12.2   1.02     355.     146.</span></span></code></pre>
<p>The result is a data frame with one row per variable and one column
per summary statistic or convergence diagnostic. The summaries
<code>rhat</code>, <code>ess_bulk</code>, and <code>ess_tail</code> are
described in Vehtari et al. (2020). We can choose which summaries to
compute by passing additional arguments, either functions or names of
functions. For instance, if we only wanted the mean and its
corresponding Monte Carlo Standard Error (MCSE) we could use either of
these options:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the function mcse_mean is provided by the posterior package</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">eight_schools_df</span>, <span class="st">"mean"</span>, <span class="st">"mcse_mean"</span><span class="op">)</span> </span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">eight_schools_df</span>, <span class="va">mean</span>, <span class="va">mcse_mean</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">s1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">##    variable  mean mcse_mean</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> mu        4.18     0.150</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> tau       4.16     0.213</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> theta[1]  6.75     0.319</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> theta[2]  5.25     0.202</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> theta[3]  3.04     0.447</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> theta[4]  4.86     0.189</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> theta[5]  3.22     0.232</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> theta[6]  3.99     0.222</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> theta[7]  6.50     0.250</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> theta[8]  4.57     0.273</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="changing-column-names">Changing column names<a class="anchor" aria-label="anchor" href="#changing-column-names"></a>
</h3>
<p>The column names in the output can be changed by providing the
functions as name-value pairs, where the name is the name to use in the
output and the value is a function name or definition. For example, here
we change the names <code>mean</code> and <code>sd</code> to
<code>posterior_mean</code> and <code>posterior_sd</code>.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">eight_schools_df</span>, posterior_mean <span class="op">=</span> <span class="va">mean</span>, posterior_sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">##    variable posterior_mean posterior_sd</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> mu                 4.18         3.40</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> tau                4.16         3.58</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> theta[1]           6.75         6.30</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> theta[2]           5.25         4.63</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> theta[3]           3.04         6.80</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> theta[4]           4.86         4.92</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> theta[5]           3.22         5.08</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> theta[6]           3.99         5.16</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> theta[7]           6.50         5.26</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> theta[8]           4.57         5.25</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="using-custom-functions">Using custom functions<a class="anchor" aria-label="anchor" href="#using-custom-functions"></a>
</h3>
<p>For a function to work with <code><a href="../reference/draws_summary.html">summarise_draws()</a></code>, it needs
to take a vector or matrix of numeric values and return a single numeric
value or a named vector of numeric values. Additional arguments to the
function can be specified in a list passed to the <code>.args</code>
argument.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weighted_mean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">wts</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="va">wts</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">wts</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="../reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span></span>
<span>  <span class="va">eight_schools_df</span>, </span>
<span>  <span class="va">weighted_mean</span>, </span>
<span>  .args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>wts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fu"><a href="../reference/draws-index.html">ndraws</a></span><span class="op">(</span><span class="va">eight_schools_df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 2</span></span></span>
<span><span class="co">##    variable weighted_mean</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> mu                4.13</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> tau               4.07</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> theta[1]          6.93</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> theta[2]          5.54</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> theta[3]          3.35</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> theta[4]          5.03</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> theta[5]          3.23</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> theta[6]          3.52</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> theta[7]          6.59</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> theta[8]          4.58</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="specifying-functions-using-lambda-like-syntax">Specifying functions using lambda-like syntax<a class="anchor" aria-label="anchor" href="#specifying-functions-using-lambda-like-syntax"></a>
</h3>
<p>It is also possible to specify a summary function using a one-sided
formula that follows the conventions supported by
<code><a href="https://rlang.r-lib.org/reference/as_function.html" class="external-link">rlang::as_function()</a></code>. For example, the function</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>can be simplified to</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for multiple arguments `.x` and `.y` can be used, see ?rlang::as_function</span></span>
<span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">.</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Both can be used with <code><a href="../reference/draws_summary.html">summarise_draws()</a></code> and produce the
same output:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">eight_schools_df</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">##    variable `40%` `60%`</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> mu        3.41  5.35</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> tau       2.47  3.96</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> theta[1]  4.95  7.01</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> theta[2]  4.32  6.13</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> theta[3]  2.54  5.33</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> theta[4]  3.78  6.11</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> theta[5]  2.69  4.69</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> theta[6]  2.92  5.47</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> theta[7]  4.81  7.33</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> theta[8]  3.50  5.92</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">eight_schools_df</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">.x</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">##    variable `40%` `60%`</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> mu        3.41  5.35</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> tau       2.47  3.96</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> theta[1]  4.95  7.01</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> theta[2]  4.32  6.13</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> theta[3]  2.54  5.33</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> theta[4]  3.78  6.11</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> theta[5]  2.69  4.69</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> theta[6]  2.92  5.47</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> theta[7]  4.81  7.33</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> theta[8]  3.50  5.92</span></span></code></pre>
<p>See <code><a href="https://rlang.r-lib.org/reference/as_function.html" class="external-link">help("as_function", "rlang")</a></code> for details on
specifying these functions.</p>
</div>
<div class="section level3">
<h3 id="other-diagnostics">Other diagnostics<a class="anchor" aria-label="anchor" href="#other-diagnostics"></a>
</h3>
<p>In addition to the default diagnostic functions used by
<code><a href="../reference/draws_summary.html">summarise_draws()</a></code> (<code><a href="../reference/rhat.html">rhat()</a></code>,
<code><a href="../reference/ess_bulk.html">ess_bulk()</a></code>, <code><a href="../reference/ess_tail.html">ess_tail()</a></code>), posterior also
provides additional diagnostics like effective sample sizes and Monte
Carlo standard errors for quantiles and standard deviations, an
experimental new diagnostic called R*, and others. For a list of
available diagnostics and links to their individual help pages see
<code><a href="../reference/diagnostics.html">help("diagnostics", "posterior")</a></code>.</p>
<p>If you have suggestions for additional diagnostics that should be
implemented in posterior, please open an issue at <a href="https://github.com/stan-dev/posterior/issues" class="external-link uri">https://github.com/stan-dev/posterior/issues</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="other-methods-for-working-with-draws-objects">Other methods for working with <code>draws</code> objects<a class="anchor" aria-label="anchor" href="#other-methods-for-working-with-draws-objects"></a>
</h2>
<p>In addition to the methods demonstrated in this vignette, posterior
has various other methods available for working with <code>draws</code>
objects. The following is a (potentially incomplete) list.</p>
<table class="table">
<colgroup>
<col width="40%">
<col width="59%">
</colgroup>
<thead><tr class="header">
<th align="left"><strong>Method</strong></th>
<th align="left"><strong>Description</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code><a href="../reference/order_draws.html">order_draws()</a></code></td>
<td align="left">Order <code>draws</code> objects according to iteration
and chain number</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/repair_draws.html">repair_draws()</a></code></td>
<td align="left">Repair indices of <code>draws</code> objects so that
iterations chains, and draws are continuously and consistently
numbered</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/resample_draws.html">resample_draws()</a></code></td>
<td align="left">Resample <code>draws</code> objects according to
provided weights</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/thin_draws.html">thin_draws()</a></code></td>
<td align="left">Thin <code>draws</code> objects to reduce size and
autocorrelation</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/weight_draws.html">weight_draws()</a></code></td>
<td align="left">Add weights to draws objects, with one weight per draw,
for use in subsequent weighting operations</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/extract_variable.html">extract_variable()</a></code></td>
<td align="left">Extract a vector of draws of a single variable</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/extract_variable_matrix.html">extract_variable_matrix()</a></code></td>
<td align="left">Extract an iterations x chains matrix of draws of a
single variable</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/merge_chains.html">merge_chains()</a></code></td>
<td align="left">Merge chains of <code>draws</code> objects into a
single chain.</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/split_chains.html">split_chains()</a></code></td>
<td align="left">Split chains of <code>draws</code> objects by halving
the number of iterations per chain and doubling the number of
chains.</td>
</tr>
</tbody>
</table>
<p>If you have suggestions for additional methods that would be useful
for working with <code>draws</code> objects, please open an issue at <a href="https://github.com/stan-dev/posterior/issues" class="external-link uri">https://github.com/stan-dev/posterior/issues</a>.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Gelman A., Carlin J. B., Stern H. S., David B. Dunson D. B., Vehtari,
A., &amp; Rubin D. B. (2013). <em>Bayesian Data Analysis, Third
Edition</em>. Chapman and Hall/CRC.</p>
<p>Vehtari A., Gelman A., Simpson D., Carpenter B., &amp; Bürkner P. C.
(2020). Rank-normalization, folding, and localization: An improved Rhat
for assessing convergence of MCMC. <em>Bayesian Analysis</em>,
16(2):667-718.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Paul-Christian Bürkner, Jonah Gabry, Matthew Kay, Aki Vehtari.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
