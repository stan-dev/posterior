<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>rvar: The Random Variable Datatype • posterior</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="rvar: The Random Variable Datatype">
<meta property="og:description" content="posterior">
<meta property="og:image" content="https://mc-stan.org/posterior/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">posterior</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://mc-stan.org/rstan" class="external-link">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/cmdstanr" class="external-link">cmdstanr</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstanarm" class="external-link">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/bayesplot" class="external-link">bayesplot</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan" class="external-link">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo" class="external-link">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/projpred" class="external-link">projpred</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools" class="external-link">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mc-stan.org" class="external-link">Stan</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/mcmc_stan" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/posterior" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>rvar: The Random Variable Datatype</h1>
                        <h4 data-toc-skip class="author">Matthew
Kay</h4>
            
            <h4 data-toc-skip class="date">2024-07-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/posterior/blob/HEAD/vignettes/rvar.Rmd" class="external-link"><code>vignettes/rvar.Rmd</code></a></small>
      <div class="hidden name"><code>rvar.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette describes the <code><a href="../reference/rvar.html">rvar()</a></code> datatype, a
multidimensional, sample-based representation of random variables
designed to act as much like base R arrays as possible (e.g., by
supporting many math operators and functions). This format is also the
basis of the <code><a href="../reference/draws_rvars.html">draws_rvars()</a></code> format.</p>
<p>The <code><a href="../reference/rvar.html">rvar()</a></code> datatype is inspired by the <a href="https://cran.r-project.org/package=rv" class="external-link">rv</a> package and <a href="https://doi.org/10.1007%2Fs11222-007-9020-4" class="external-link">Kerman and Gelman
(2007)</a>, though with a slightly different backing format
(multidimensional arrays). It is also designed to interoperate with
vectorized distributions in the <a href="https://pkg.mitchelloharawild.com/distributional/" class="external-link">distributional</a>
package, to be able to be used inside <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code>s and
<code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble()</a></code>s, and to be used with distribution visualizations
in the <a href="https://mjskay.github.io/ggdist/" class="external-link">ggdist</a>
package.</p>
</div>
<div class="section level2">
<h2 id="the-rvars-datatype">The <code>rvars</code> datatype<a class="anchor" aria-label="anchor" href="#the-rvars-datatype"></a>
</h2>
<p>The <code><a href="../reference/rvar.html">rvar()</a></code> datatype is a wrapper around a
multidimensional array where the first dimension is the number of draws
in the random variable. The most direct way to create a random variable
is to pass such an array to the <code><a href="../reference/rvar.html">rvar()</a></code> function.</p>
<p>For example, to create a “scalar” <code>rvar</code>, one would pass a
one-dimensional array or a vector whose length (here <code>4000</code>)
is the desired number of draws:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rvar.html">rvar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4000</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[1] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 1 ± 1</span></span></code></pre>
<p>The default display of an <code>rvar</code> shows the mean and
standard deviation of each element of the array.</p>
<p>We can create random vectors by adding an additional dimension beyond
just the draws dimension to the input array:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">4</span>   <span class="co"># length of output vector</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rvar.html">rvar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4000</span><span class="op">*</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4000</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[4] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 1.01 ± 0.99  1.02 ± 0.99  0.98 ± 1.00  0.99 ± 1.02</span></span></code></pre>
<p>Or we can create a random matrix:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rows</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rvar.html">rvar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4000</span> <span class="op">*</span> <span class="va">rows</span> <span class="op">*</span> <span class="va">cols</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4000</span>, <span class="va">rows</span>, <span class="va">cols</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[4,3] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">##      [,1]         [,2]         [,3]        </span></span>
<span><span class="co">## [1,] 1.00 ± 0.98  1.00 ± 1.00  0.97 ± 1.00 </span></span>
<span><span class="co">## [2,] 1.00 ± 1.01  1.01 ± 1.02  0.99 ± 0.99 </span></span>
<span><span class="co">## [3,] 1.02 ± 1.01  0.99 ± 1.00  1.00 ± 0.99 </span></span>
<span><span class="co">## [4,] 1.01 ± 1.01  1.02 ± 1.00  1.00 ± 1.01</span></span></code></pre>
<p>Or any array up to an arbitrary number of dimensions. The array
backing an <code>rvar</code> can be accessed (and modified, with
caution) via <code><a href="../reference/draws_of.html">draws_of()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/draws_of.html">draws_of</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  num [1:4000, 1:4, 1:3] -0.6879 0.0448 0.3519 1.261 -0.2197 ...</span></span>
<span><span class="co">##  - attr(*, "dimnames")=List of 3</span></span>
<span><span class="co">##   ..$ : chr [1:4000] "1" "2" "3" "4" ...</span></span>
<span><span class="co">##   ..$ : NULL</span></span>
<span><span class="co">##   ..$ : NULL</span></span></code></pre>
<p>While the above examples assume all draws come from a single chain,
<code>rvar</code>s can also contain samples from multiple chains. For
example, if your array of draws has iterations as the first dimension
and chains as the second dimension, you can use
<code>with_chains = TRUE</code> to create an <code>rvar</code> that
includes chain information:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iterations</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">chains</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">rows</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">x_array</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">iterations</span> <span class="op">*</span> <span class="va">chains</span> <span class="op">*</span> <span class="va">rows</span> <span class="op">*</span> <span class="va">cols</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">iterations</span>, <span class="va">chains</span>, <span class="va">rows</span>, <span class="va">cols</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rvar.html">rvar</a></span><span class="op">(</span><span class="va">x_array</span>, with_chains <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;1000,4&gt;[4,3] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">##      [,1]         [,2]         [,3]        </span></span>
<span><span class="co">## [1,] 0.97 ± 1.00  1.00 ± 0.99  1.02 ± 0.99 </span></span>
<span><span class="co">## [2,] 1.02 ± 1.00  0.99 ± 1.01  1.01 ± 0.99 </span></span>
<span><span class="co">## [3,] 1.00 ± 1.00  1.00 ± 1.00  1.01 ± 1.00 </span></span>
<span><span class="co">## [4,] 1.03 ± 0.99  1.05 ± 1.00  0.98 ± 1.00</span></span></code></pre>
<p>Manual construction and modification of <code>rvar</code>s in this
way is not always recommended unless you need it for performance
reasons: several other higher-level interfaces to constructing and
manipulating <code>rvar</code>s are described below.</p>
<div class="section level3">
<h3 id="rvar_factor">
<code>rvar_factor</code> and <code>rvar_ordered</code> subtypes<a class="anchor" aria-label="anchor" href="#rvar_factor"></a>
</h3>
<p>You can also use <code>rvar</code>s to represent discrete
distributions, using the <code><a href="../reference/rvar_factor.html">rvar_factor()</a></code> and
<code><a href="../reference/rvar_factor.html">rvar_ordered()</a></code> subtypes. If you attempt to create an
<code>rvar</code> using character values or a <code>factor</code>, it
will automatically be treated as an <code>rvar_factor</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rvar.html">rvar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span><span class="op">)</span>, <span class="fl">4000</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar_factor&lt;4000&gt;[1] <span style="color: #949494;">mode &lt;entropy&gt;:</span></span></span>
<span><span class="co">## [1] a &lt;0.74&gt; </span></span>
<span><span class="co">## 3 levels: a b c</span></span></code></pre>
<p>Numeric arrays with a <code>"levels"</code> attribute can also be
passed to <code><a href="../reference/rvar_factor.html">rvar_factor()</a></code>. This (along with conversion of
character values) means output from
<code><a href="https://mc-stan.org/rstantools/reference/posterior_predict.html" class="external-link">rstanarm::posterior_predict()</a></code> and
<code><a href="https://mc-stan.org/rstantools/reference/posterior_predict.html" class="external-link">brms::posterior_predict()</a></code> on categorical models can be
passed directly to <code><a href="../reference/rvar_factor.html">rvar_factor()</a></code>.</p>
<p>The default display shows the mode (as returned by
<code><a href="../reference/modal_category.html">modal_category()</a></code>) and normalized entropy
(<code><a href="../reference/entropy.html">entropy()</a></code>), which is Shannon entropy scaled by the maximum
possible entropy for a distribution with the same number of levels: thus
0 means all probability is concentrated in one category, and 1 means the
distribution is uniform.</p>
<p>You can construct an ordered factor using <code><a href="../reference/rvar_factor.html">rvar_ordered()</a></code>
(or by passing an <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered()</a></code> vector to
<code><a href="../reference/rvar.html">rvar()</a></code>):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rvar_factor.html">rvar_ordered</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span><span class="op">)</span>, <span class="fl">4000</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar_ordered&lt;4000&gt;[1] <span style="color: #949494;">mode &lt;dissent&gt;:</span></span></span>
<span><span class="co">## [1] a &lt;0.55&gt; </span></span>
<span><span class="co">## 3 levels: a &lt; b &lt; c</span></span></code></pre>
<p>For <code><a href="../reference/rvar_factor.html">rvar_ordered()</a></code>, the default display is mode and
dissention (<code><a href="../reference/dissent.html">dissent()</a></code>), which is 0 when all probability is
concentrated in one category, and 1 when the distribution is bimodal at
opposite ends of the scale.</p>
<p><code>rvar_factor</code>s attempt to mimic <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor()</a></code> and
<code>rvar_ordered</code>s attempt to mimic <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered()</a></code>s, by
implementing factor-specific functions like <code><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels()</a></code>.
Comparison operations are also implemented where valid. For example, in
<code>x</code> as defined above, approximately 90% of draws should be
less than <code>"b"</code> (which means the <code>"a"</code> and
<code>"b"</code> levels):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;=</span> <span class="st">"b"</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[1] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 0.9 ± 0.29</span></span></code></pre>
<p><code>rvar</code>s also supply an implementation of
<code><a href="../reference/match.html">match()</a></code> and <code>%in%</code>, which can be especially
useful with <code>rvar_factor</code>s:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op"><a href="../reference/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[1] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 0.8 ± 0.4</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="the-draws_rvars-datatype">The <code>draws_rvars</code> datatype<a class="anchor" aria-label="anchor" href="#the-draws_rvars-datatype"></a>
</h2>
<p>The <code><a href="../reference/draws_rvars.html">draws_rvars()</a></code> datatype, like all <code>draws</code>
datatypes in posterior, contains multiple variables in a joint sample
from some distribution (e.g. a posterior or prior distribution).</p>
<p>You can construct <code><a href="../reference/draws_rvars.html">draws_rvars()</a></code> objects directly using
the <code><a href="../reference/draws_rvars.html">draws_rvars()</a></code> function. The input <code>rvar</code>s
must have the same number of chains and iterations, but can otherwise
have different shapes:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws_rvars.html">draws_rvars</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="fu"><a href="../reference/rvar.html">rvar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">iterations</span> <span class="op">*</span> <span class="va">chains</span><span class="op">)</span>, nchains <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d</span></span></code></pre></div>
<pre><code><span><span class="co">## # A draws_rvars: 4000 iterations, 1 chains, and 2 variables</span></span>
<span><span class="co">## $x: rvar_ordered&lt;4000&gt;[1] <span style="color: #949494;">mode &lt;dissent&gt;:</span></span></span>
<span><span class="co">## [1] a &lt;0.55&gt; </span></span>
<span><span class="co">## 3 levels: a &lt; b &lt; c</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $y: rvar&lt;4000&gt;[1] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] -0.012 ± 0.98</span></span></code></pre>
<p>Existing objects can also be converted to the
<code><a href="../reference/draws_rvars.html">draws_rvars()</a></code> format using <code><a href="../reference/draws_rvars.html">as_draws_rvars()</a></code>.
Below is the <code>example_draws("multi_normal")</code> dataset
converted into the <code><a href="../reference/draws_rvars.html">draws_rvars()</a></code> format. This dataset has
100 iterations from 4 chains from the posterior of a a 3-dimensional
multivariate normal model. The <code>mu</code> variable is a mean vector
of length 3 and the <code>Sigma</code> variable is a <span class="math inline">\(3 \times 3\)</span> covariance matrix:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws_rvars.html">as_draws_rvars</a></span><span class="op">(</span><span class="fu"><a href="../reference/example_draws.html">example_draws</a></span><span class="op">(</span><span class="st">"multi_normal"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">post</span></span></code></pre></div>
<pre><code><span><span class="co">## # A draws_rvars: 100 iterations, 4 chains, and 2 variables</span></span>
<span><span class="co">## $mu: rvar&lt;100,4&gt;[3] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 0.051 ± 0.11  0.111 ± 0.20  0.186 ± 0.31 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Sigma: rvar&lt;100,4&gt;[3,3] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">##      [,1]          [,2]          [,3]         </span></span>
<span><span class="co">## [1,]  1.28 ± 0.17   0.53 ± 0.20  -0.40 ± 0.28 </span></span>
<span><span class="co">## [2,]  0.53 ± 0.20   3.67 ± 0.45  -2.10 ± 0.48 </span></span>
<span><span class="co">## [3,] -0.40 ± 0.28  -2.10 ± 0.48   8.12 ± 0.95</span></span></code></pre>
<p>The <code><a href="../reference/draws_rvars.html">draws_rvars()</a></code> datatype works much the same way that
other <code>draws</code> formats do; see the main package vignette at
<code><a href="../articles/posterior.html">vignette("posterior")</a></code> for an introduction to
<code>draws</code> objects. One difference is that
<code>draws_rvars</code> counts variables differently, because it allows
variables to be multidimensional. For example, the <code>post</code>
object above contains two variables, <code>mu</code> and
<code>Sigma</code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/variables.html">variables</a></span><span class="op">(</span><span class="va">post</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "mu"    "Sigma"</span></span></code></pre>
<p>But converted to a <code><a href="../reference/draws_list.html">draws_list()</a></code>, it contains one
variable for each combination of the dimensions of its variables:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/variables.html">variables</a></span><span class="op">(</span><span class="fu"><a href="../reference/draws_list.html">as_draws_list</a></span><span class="op">(</span><span class="va">post</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "mu[1]"      "mu[2]"      "mu[3]"      "Sigma[1,1]" "Sigma[2,1]"</span></span>
<span><span class="co">##  [6] "Sigma[3,1]" "Sigma[1,2]" "Sigma[2,2]" "Sigma[3,2]" "Sigma[1,3]"</span></span>
<span><span class="co">## [11] "Sigma[2,3]" "Sigma[3,3]"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="math-with-rvars">Math with <code>rvar</code>s<a class="anchor" aria-label="anchor" href="#math-with-rvars"></a>
</h2>
<p>The <code><a href="../reference/rvar.html">rvar()</a></code> datatype implements most math operations,
including basic arithmetic, functions in the <em>Math</em> and
<em>Summary</em> groups, like <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log()</a></code> and <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp()</a></code>
(see <code><a href="https://rdrr.io/r/base/groupGeneric.html" class="external-link">help("groupGeneric")</a></code> for a list), and more. Binary
operators can be performed between multiple <code>rvar</code>s or
between <code>rvar</code>s and <code>numeric</code>s. A simple
example:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">post</span><span class="op">$</span><span class="va">mu</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="va">post</span><span class="op">$</span><span class="va">Sigma</span></span>
<span></span>
<span><span class="va">mu</span> <span class="op">+</span> <span class="fl">1</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;100,4&gt;[3] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 1.1 ± 0.11  1.1 ± 0.20  1.2 ± 0.31</span></span></code></pre>
<p>Matrix multiplication is also implemented (using a tensor product
under the hood). In R &lt; 4.3, the normal matrix multiplication
operator (<code>%*%</code>) cannot be properly implemented for S3
datatypes, so <code>rvar</code> uses <code>%**%</code> instead. In R ≥
4.3, which does support matrix multiplication for S3 datatypes, you can
use <code>%*%</code> to matrix-multiply <code>rvar</code>s.</p>
<p>A trivial example:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Sigma</span> <span class="op"><a href="../reference/rvar-matmult.html">%**%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;100,4&gt;[3,3] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">##      [,1]          [,2]          [,3]         </span></span>
<span><span class="co">## [1,]  1.28 ± 0.17   1.05 ± 0.40  -1.21 ± 0.85 </span></span>
<span><span class="co">## [2,]  0.53 ± 0.20   7.33 ± 0.89  -6.30 ± 1.44 </span></span>
<span><span class="co">## [3,] -0.40 ± 0.28  -4.20 ± 0.96  24.35 ± 2.84</span></span></code></pre>
<p>The set of mathematical functions and operators supported by
<code>rvar</code>s includes:</p>
<table class="table">
<colgroup>
<col width="53%">
<col width="46%">
</colgroup>
<thead><tr class="header">
<th align="left">Group</th>
<th align="left">Functions and operators</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Arithmetic operators</td>
<td align="left">
<code>+</code>, <code>-</code>, <code>*</code>,
<code>/</code>, <code>^</code>, <code>%%</code>, <code>%/%</code>
</td>
</tr>
<tr class="even">
<td align="left">Logical operators</td>
<td align="left">
<code>&amp;</code>, <code>|</code>, <code>!</code>
</td>
</tr>
<tr class="odd">
<td align="left">Comparison operators</td>
<td align="left">
<code>==</code>, <code>!=</code>, <code>&lt;</code>,
<code>&lt;=</code>, <code>&gt;=</code>, <code>&gt;</code>
</td>
</tr>
<tr class="even">
<td align="left">Value matching</td>
<td align="left">
<code><a href="../reference/match.html">match()</a></code>, <code>%in%</code>
</td>
</tr>
<tr class="odd">
<td align="left">Matrix multiplication</td>
<td align="left">
<code>%**%</code>, <code>%*%</code> (R ≥ 4.3 only)</td>
</tr>
<tr class="even">
<td align="left">Basic functions</td>
<td align="left">
<code><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs()</a></code>,
<code><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign()</a></code><br><code><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt()</a></code><br><code><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor()</a></code>,
<code><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling()</a></code>, <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc()</a></code>, <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">round()</a></code>,
<code><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif()</a></code>
</td>
</tr>
<tr class="odd">
<td align="left">Logarithms and exponentials</td>
<td align="left">
<code><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp()</a></code>,
<code><a href="https://rdrr.io/r/base/Log.html" class="external-link">expm1()</a></code><br><code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log()</a></code>, <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10()</a></code>,
<code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2()</a></code>, <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log1p()</a></code>
</td>
</tr>
<tr class="even">
<td align="left">Trigonometric functions</td>
<td align="left">
<code><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos()</a></code>, <code><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin()</a></code>,
<code><a href="https://rdrr.io/r/base/Trig.html" class="external-link">tan()</a></code><br><code><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cospi()</a></code>, <code><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sinpi()</a></code>,
<code><a href="https://rdrr.io/r/base/Trig.html" class="external-link">tanpi()</a></code><br><code><a href="https://rdrr.io/r/base/Trig.html" class="external-link">acos()</a></code>, <code><a href="https://rdrr.io/r/base/Trig.html" class="external-link">asin()</a></code>,
<code><a href="https://rdrr.io/r/base/Trig.html" class="external-link">atan()</a></code>
</td>
</tr>
<tr class="odd">
<td align="left">Hyperbolic functions</td>
<td align="left">
<code><a href="https://rdrr.io/r/base/Hyperbolic.html" class="external-link">cosh()</a></code>, <code><a href="https://rdrr.io/r/base/Hyperbolic.html" class="external-link">sinh()</a></code>,
<code><a href="https://rdrr.io/r/base/Hyperbolic.html" class="external-link">tanh()</a></code><br><code><a href="https://rdrr.io/r/base/Hyperbolic.html" class="external-link">acosh()</a></code>, <code><a href="https://rdrr.io/r/base/Hyperbolic.html" class="external-link">asinh()</a></code>,
<code><a href="https://rdrr.io/r/base/Hyperbolic.html" class="external-link">atanh()</a></code>
</td>
</tr>
<tr class="even">
<td align="left">Special functions</td>
<td align="left">
<code><a href="https://rdrr.io/r/base/Special.html" class="external-link">lgamma()</a></code>, <code><a href="https://rdrr.io/r/base/Special.html" class="external-link">gamma()</a></code>,
<code><a href="https://rdrr.io/r/base/Special.html" class="external-link">digamma()</a></code>, <code><a href="https://rdrr.io/r/base/Special.html" class="external-link">trigamma()</a></code>
</td>
</tr>
<tr class="odd">
<td align="left">Cumulative functions</td>
<td align="left">
<code><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum()</a></code>, <code><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumprod()</a></code>,
<code><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cummax()</a></code>, <code><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cummin()</a></code>
</td>
</tr>
<tr class="even">
<td align="left">Array transposition</td>
<td align="left">
<code><a href="https://rdrr.io/r/base/t.html" class="external-link">t()</a></code>, <code><a href="https://rdrr.io/r/base/aperm.html" class="external-link">aperm()</a></code>
</td>
</tr>
<tr class="odd">
<td align="left">Matrix decomposition</td>
<td align="left"><code><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol()</a></code></td>
</tr>
<tr class="even">
<td align="left">Matrix diagonals</td>
<td align="left"><code><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag()</a></code></td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="expectations-and-summary-functions">Expectations and summary functions<a class="anchor" aria-label="anchor" href="#expectations-and-summary-functions"></a>
</h2>
<p>The <code><a href="../reference/rvar-summaries-over-draws.html">E()</a></code> function is an alias of <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code>,
producing means within each cell of an <code>rvar</code>. For example,
given <code>mu</code>:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;100,4&gt;[3] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 0.051 ± 0.11  0.111 ± 0.20  0.186 ± 0.31</span></span></code></pre>
<p>We can get the expectation of each cell of <code>mu</code>:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rvar-summaries-over-draws.html">E</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.05139284 0.11132363 0.18581977</span></span></code></pre>
<p>Expectations of logical expressions are probabilities, and can be
computed either with <code><a href="../reference/rvar-summaries-over-draws.html">E()</a></code> / <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code> or with
<code><a href="../reference/rvar-summaries-over-draws.html">Pr()</a></code>. <code><a href="../reference/rvar-summaries-over-draws.html">Pr()</a></code> is provided as notational sugar,
but also checks that the input is a logical variable before taking the
mean:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rvar-summaries-over-draws.html">Pr</a></span><span class="op">(</span><span class="va">mu</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.6600 0.6900 0.7025</span></span></code></pre>
<p>More generally, the <code>rvar</code> data type provides two types of
summary functions:</p>
<ol style="list-style-type: decimal">
<li>
<p>Summary functions that mimic base-R vector summary functions,
except applied to <code>rvar</code> vectors. These apply their summaries
<strong>over</strong> elements of the input vectors
<strong>within</strong> each draw, generally returning an
<code>rvar</code> of length 1. These functions are prefixed with
<code>rvar_</code> as a reminder that they return <code>rvar</code>s.
Here is an example of <code><a href="../reference/rvar-summaries-within-draws.html">rvar_mean()</a></code>:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rvar-summaries-within-draws.html">rvar_mean</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;100,4&gt;[1] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 0.12 ± 0.11</span></span></code></pre>
</li>
<li>
<p>Summary functions that summarise <strong>within</strong> elements
of input vectors and <strong>over</strong> draws. These summary
functions generally return base arrays (<code>numeric</code> or
<code>logical</code>) of the same shape as the input <code>rvar</code>,
and are especially useful for diagnostic summaries. These summary
functions are not prefixed with <code>rvar_</code> as they do not return
<code>rvar</code>s. Here is an example of <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code>:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.05139284 0.11132363 0.18581977</span></span></code></pre>
<p>You should expect the same values from these functions (though in a
different shape) when you use them with <code><a href="../reference/draws_summary.html">summarise_draws()</a></code>,
for example:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">mean</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">##   variable   mean</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> mu[1]    0.051<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> mu[2]    0.111 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> mu[3]    0.186</span></span></code></pre>
</li>
</ol>
<p>Here is a table of both types of summary functions:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="38%">
<col width="41%">
</colgroup>
<thead><tr class="header">
<th></th>
<th align="left">1. Summarise <em>within</em> draws,<br><em>over</em>
elements</th>
<th align="left">2. Summarise <em>over</em> draws,<br><em>within</em>
elements<br>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<strong>Output format</strong><br>of <code>res = f(x)</code>
</td>
<td align="left">
<code>rvar</code> of length 1</td>
<td align="left">
<code>array</code> of same shape as input
<code>rvar</code>
</td>
</tr>
<tr class="even">
<td><strong>Help page</strong></td>
<td align="left"><code><a href="../reference/rvar-summaries-within-draws.html">help("rvar-summaries-within-draws")</a></code></td>
<td align="left"><code><a href="../reference/rvar-summaries-over-draws.html">help("rvar-summaries-over-draws")</a></code></td>
</tr>
<tr class="odd">
<td>Numeric summaries</td>
<td align="left">
<code><a href="../reference/rvar-summaries-within-draws.html">rvar_median()</a></code><br><code><a href="../reference/rvar-summaries-within-draws.html">rvar_sum()</a></code>,
<code><a href="../reference/rvar-summaries-within-draws.html">rvar_prod()</a></code><br><code><a href="../reference/rvar-summaries-within-draws.html">rvar_min()</a></code>,
<code><a href="../reference/rvar-summaries-within-draws.html">rvar_max()</a></code>
</td>
<td align="left">
<code><a href="https://rdrr.io/r/stats/median.html" class="external-link">median()</a></code><br><code><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum()</a></code>,
<code><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod()</a></code><br><code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min()</a></code>, <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max()</a></code>
</td>
</tr>
<tr class="even">
<td>Mean</td>
<td align="left">
<code><a href="../reference/rvar-summaries-within-draws.html">rvar_mean()</a></code><br><em>N/A</em>
</td>
<td align="left">
<code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code>,
<code><a href="../reference/rvar-summaries-over-draws.html">E()</a></code><br><code><a href="../reference/rvar-summaries-over-draws.html">Pr()</a></code>: enforces that input is
<code>logical</code>
</td>
</tr>
<tr class="odd">
<td>Spread</td>
<td align="left">
<code><a href="../reference/rvar-summaries-within-draws.html">rvar_sd()</a></code> <br><code><a href="../reference/rvar-summaries-within-draws.html">rvar_var()</a></code> <br><code><a href="../reference/rvar-summaries-within-draws.html">rvar_mad()</a></code>
</td>
<td align="left">
<code><a href="../reference/rvar-summaries-over-draws.html">sd()</a></code><br><code><a href="../reference/rvar-summaries-over-draws.html">var()</a></code>,
<code><a href="https://pkg.mitchelloharawild.com/distributional/reference/variance.html" class="external-link">variance()</a></code><br><code><a href="../reference/rvar-summaries-over-draws.html">mad()</a></code>
</td>
</tr>
<tr class="even">
<td>Range</td>
<td align="left">
<code><a href="../reference/rvar-summaries-within-draws.html">rvar_range()</a></code><br><strong>Note:</strong>
<code>length(res) == 2</code>
</td>
<td align="left">
<code><a href="https://rdrr.io/r/base/range.html" class="external-link">range()</a></code><br><strong>Note:</strong>
<code>dim(res) == c(2, dim(x))</code>
</td>
</tr>
<tr class="odd">
<td>Quantiles</td>
<td align="left">
<code><a href="../reference/rvar-summaries-within-draws.html">rvar_quantile()</a></code><br><strong>Note:</strong>
<code>length(res) == length(probs)</code>
</td>
<td align="left">
<code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile()</a></code><br><strong>Note:</strong>
<code>dim(res) == c(length(probs), dim(x))</code>
</td>
</tr>
<tr class="even">
<td>Logical summaries</td>
<td align="left">
<code><a href="../reference/rvar-summaries-within-draws.html">rvar_all()</a></code>, <code><a href="../reference/rvar-summaries-within-draws.html">rvar_any()</a></code>
</td>
<td align="left">
<code><a href="https://rdrr.io/r/base/all.html" class="external-link">all()</a></code>, <code><a href="https://rdrr.io/r/base/any.html" class="external-link">any()</a></code>
</td>
</tr>
<tr class="odd">
<td>Special value predicates</td>
<td align="left">
<code><a href="../reference/rvar_is_finite.html">rvar_is_finite()</a></code><br><code><a href="../reference/rvar_is_finite.html">rvar_is_infinite()</a></code><br><code><a href="../reference/rvar_is_finite.html">rvar_is_nan()</a></code><br><code><a href="../reference/rvar_is_finite.html">rvar_is_na()</a></code><br><strong>Note:</strong>
<code>dim(res) == dim(x)</code>. These functions act within draws but do
not summarise over elements.</td>
<td align="left">
<code><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite()</a></code><br><code><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.infinite()</a></code><br><code><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan()</a></code><br><code><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na()</a></code><br><strong>Note:</strong>
<code>res[i] == TRUE</code> if <code>x[i]</code> has any draws matching
predicate (except for <code><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite()</a></code>, where all draws in
<code>x[i]</code> must match)</td>
</tr>
<tr class="even">
<td>Diagnostics</td>
<td align="left"><em>N/A</em></td>
<td align="left">
<code><a href="../reference/ess_basic.html">ess_basic()</a></code>, <code><a href="../reference/ess_bulk.html">ess_bulk()</a></code>,
<code><a href="../reference/ess_quantile.html">ess_quantile()</a></code>, <code><a href="../reference/ess_sd.html">ess_sd()</a></code>,
<code><a href="../reference/ess_tail.html">ess_tail()</a></code>,<br><code><a href="../reference/mcse_mean.html">mcse_mean()</a></code>,
<code><a href="../reference/mcse_quantile.html">mcse_quantile()</a></code>,
<code><a href="../reference/mcse_sd.html">mcse_sd()</a></code><br><code><a href="../reference/rhat.html">rhat()</a></code>,
<code><a href="../reference/rhat_basic.html">rhat_basic()</a></code>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="constants">Constants<a class="anchor" aria-label="anchor" href="#constants"></a>
</h2>
<p>Constant <code>rvar</code>s can be constructed by converting numeric
vectors or arrays into <code>rvar</code>s using <code><a href="../reference/as_rvar.html">as_rvar()</a></code>,
which will return an <code>rvar</code> with one draw and the same
dimensions as its input:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">const</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_rvar.html">as_rvar</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">const</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;1&gt;[3] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 1 ± NA  2 ± NA  3 ± NA</span></span></code></pre>
<p>While normally <code>rvar</code>s must have the same number of draws
to be used in the same expression, <code>rvar</code>s with one draw are
treated like constants, and can be combined with other
<code>rvar</code>s:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu</span> <span class="op">+</span> <span class="va">const</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;100,4&gt;[3] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 1.1 ± 0.11  2.1 ± 0.20  3.2 ± 0.31</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="using-existing-r-functions-and-expressions-with-rvars">Using existing R functions and expressions with
<code>rvar</code>s<a class="anchor" aria-label="anchor" href="#using-existing-r-functions-and-expressions-with-rvars"></a>
</h2>
<p>While <code>rvar</code>s attempt to emulate as much of the
functionality of base R arrays as possible, there are situations in
which an existing R function may not work directly with an
<code>rvar</code>. There are several approaches to solving this
problem.</p>
<p>For example, say you wish to generate samples from the following
expression for <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\sigma\)</span>, and <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[
\begin{align}
\left[\begin{matrix}\mu_1 \\ \vdots \\ \mu_4 \end{matrix}\right]
&amp;\sim \textrm{Normal}\left(\left[\begin{matrix}1 \\ \vdots \\ 4
\end{matrix}\right],1\right)\\
\sigma &amp;\sim \textrm{Gamma}(1,1)\\
\left[\begin{matrix}x_1 \\ \vdots \\ x_4 \end{matrix}\right] &amp;\sim
\textrm{Normal}\left(\left[\begin{matrix}\mu_1 \\ \vdots \\ \mu_4
\end{matrix}\right], \sigma\right)
\end{align}
\]</span></p>
<p>There are three different approaches you might take to doing this:
converting existing R functions with <code><a href="../reference/rfun.html">rfun()</a></code>, executing
expressions of random variables with <code><a href="../reference/rdo.html">rdo()</a></code>, or evaluating
random number generator functions using <code><a href="../reference/rvar_rng.html">rvar_rng()</a></code>.</p>
<div class="section level3">
<h3 id="converting-functions-with-rfun">Converting functions with <code>rfun()</code><a class="anchor" aria-label="anchor" href="#converting-functions-with-rfun"></a>
</h3>
<p>The <code><a href="../reference/rfun.html">rfun()</a></code> wrapper converts an existing R function into
a new function that <code>rvar</code>s can be passed to it as arguments,
and which will return <code>rvar</code>s. We can use <code><a href="../reference/rfun.html">rfun()</a></code>
to convert the base <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm()</a></code> and <code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma()</a></code>
random number generating functions into functions that accept and return
<code>rvar</code>s:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rvar_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rfun.html">rfun</a></span><span class="op">(</span><span class="va">rnorm</span><span class="op">)</span></span>
<span><span class="va">rvar_gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rfun.html">rfun</a></span><span class="op">(</span><span class="va">rgamma</span><span class="op">)</span></span></code></pre></div>
<p>Then we can translate the above example into code using those
functions:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu">rvar_norm</span><span class="op">(</span><span class="fl">4</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu">rvar_gamma</span><span class="op">(</span><span class="fl">1</span>, shape <span class="op">=</span> <span class="fl">1</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">rvar_norm</span><span class="op">(</span><span class="fl">4</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[4] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 1 ± 1.7  2 ± 1.7  3 ± 1.7  4 ± 1.8</span></span></code></pre>
<p>While <code><a href="../reference/rfun.html">rfun()</a></code>-converted functions work well for
prototyping, they will generally speaking be slower than functions
designed specifically for <code>rvar</code>s. Thus, you may find you
need to adopt other strategies (like <code><a href="../reference/rvar_rng.html">rvar_rng()</a></code>, described
below; or re-writing functions to support <code>rvar</code> directly
using math operators and/or the <code><a href="../reference/draws_of.html">draws_of()</a></code> function).</p>
</div>
<div class="section level3">
<h3 id="evaluating-expressions-with-rdo">Evaluating expressions with <code>rdo()</code><a class="anchor" aria-label="anchor" href="#evaluating-expressions-with-rdo"></a>
</h3>
<p>An alternative to <code><a href="../reference/rfun.html">rfun()</a></code> is to use <code><a href="../reference/rdo.html">rdo()</a></code>,
which can be passed nearly-arbitrary R expressions. The expression will
be executed multiple times to construct an <code>rvar</code>. E.g., we
can write an expression for <code>mu</code> like in the above
example:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rdo.html">rdo</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mu</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[4] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 0.98 ± 0.98  2.02 ± 1.02  2.99 ± 1.01  3.99 ± 1.01</span></span></code></pre>
<p>We can also control the number of draws using the <code>ndraws</code>
argument:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rdo.html">rdo</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, ndraws <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">mu</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;1000&gt;[4] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 0.96 ± 1.05  1.99 ± 1.03  2.98 ± 0.98  4.01 ± 0.99</span></span></code></pre>
<p><code><a href="../reference/rdo.html">rdo()</a></code> expressions can also contain other
<code>rvar</code>s, so long as all <code>rvar</code>s in the expression
have the same number of draws. Thus, we can re-write the example above
that used <code><a href="../reference/rfun.html">rfun()</a></code> as follows:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rdo.html">rdo</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rdo.html">rdo</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">1</span>, shape <span class="op">=</span> <span class="fl">1</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rdo.html">rdo</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[4] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 0.97 ± 1.7  2.05 ± 1.7  3.05 ± 1.7  4.02 ± 1.7</span></span></code></pre>
<p>Like <code><a href="../reference/rfun.html">rfun()</a></code>, <code><a href="../reference/rdo.html">rdo()</a></code> is not necessarily fast,
so you may find it more useful for prototyping than production code.</p>
</div>
<div class="section level3">
<h3 id="evaluating-random-number-generators-with-rvar_rng">Evaluating random number generators with
<code>rvar_rng()</code><a class="anchor" aria-label="anchor" href="#evaluating-random-number-generators-with-rvar_rng"></a>
</h3>
<p><code><a href="../reference/rvar_rng.html">rvar_rng()</a></code> is an alternative to
<code><a href="../reference/rfun.html">rfun()</a></code>/<code><a href="../reference/rdo.html">rdo()</a></code> designed specifically to work
with random number generating functions that follow the typical API of
such functions in base R. Such functions, like <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm()</a></code>,
<code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma()</a></code>, <code><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom()</a></code>, etc all following this
interface:</p>
<ul>
<li>They have a first argument, <code>n</code>, giving the number of
draws to take from the distribution.</li>
<li>Their arguments for distribution parameters (<code>mean</code>,
<code>sd</code>, <code>shape</code>, <code>rate</code>, etc.) are
vectorized.</li>
<li>They return a single vector of length <code>n</code>, representing
<code>n</code> draws from the distribution.</li>
</ul>
<p>You can use any function with this interface with
<code><a href="../reference/rvar_rng.html">rvar_rng()</a></code>, and it will adapt it to be able to take
<code>rvar</code> arguments and return an <code>rvar</code>, as
follows:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rvar_rng.html">rvar_rng</a></span><span class="op">(</span><span class="va">rnorm</span>, <span class="fl">4</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rvar_rng.html">rvar_rng</a></span><span class="op">(</span><span class="va">rgamma</span>, <span class="fl">1</span>, shape <span class="op">=</span> <span class="fl">1</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rvar_rng.html">rvar_rng</a></span><span class="op">(</span><span class="va">rnorm</span>, <span class="fl">4</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[4] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 1 ± 1.8  2 ± 1.8  3 ± 1.8  4 ± 1.8</span></span></code></pre>
<p>In contrast to the <code><a href="../reference/rfun.html">rfun()</a></code> and <code><a href="../reference/rdo.html">rdo()</a></code>
examples above, <code><a href="../reference/rvar_rng.html">rvar_rng()</a></code> takes advantage of the existing
vectorization of the underlying random number generating function to
execute quickly.</p>
</div>
</div>
<div class="section level2">
<h2 id="broadcasting">Broadcasting<a class="anchor" aria-label="anchor" href="#broadcasting"></a>
</h2>
<p>Broadcasting for <code>rvar</code>s does not follow R’s vector
recycling rules. Instead, when two variables with different dimensions
are being used with basic arithmetic functions, dimensions are added
until both variables have the same number of dimensions. If two
variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> differ on the length of dimension <span class="math inline">\(d\)</span>, they can be broadcast to the same size
so long as one of the variables has dimension <span class="math inline">\(d\)</span> of size 1. Then that variable will be
broadcast up to the same size as the other variable along that
dimension. If two variables disagree on the size of a dimension and
neither has size 1, it is an error.</p>
<p>For example, consider this random matrix:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rdo.html">rdo</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[4,3] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">##      [,1]          [,2]          [,3]         </span></span>
<span><span class="co">## [1,]  0.99 ± 1.00   5.00 ± 1.00   9.02 ± 0.99 </span></span>
<span><span class="co">## [2,]  1.98 ± 1.02   5.99 ± 1.01   9.96 ± 1.00 </span></span>
<span><span class="co">## [3,]  3.03 ± 0.98   6.99 ± 1.00  11.03 ± 0.99 </span></span>
<span><span class="co">## [4,]  3.99 ± 1.01   7.99 ± 0.99  11.98 ± 1.02</span></span></code></pre>
<p>And this vector of length 3:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rdo.html">rdo</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[3] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 3.00 ± 1.00  2.02 ± 0.99  0.96 ± 0.99</span></span></code></pre>
<p>If we attempt to add <code>X</code> and <code>y</code>, it will
produce an error as vectors are by default treated as column vectors,
and <code>y</code> has length 3 while columns of <code>X</code> have
length 4:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">+</span> <span class="va">y</span></span></code></pre></div>
<pre><code><span><span class="co">## Error: Cannot broadcast array of shape [4000,3,1] to array of shape [4000,4,3]:</span></span>
<span><span class="co">## All dimensions must be 1 or equal.</span></span></code></pre>
<p>By contrast, R arrays of the same shape will simply recycle
<code>y</code> until it is the same length as <code>X</code> (regardless
of the dimensions). Thus will produce a result, though likely not the
intended result:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          [,1]      [,2]      [,3]</span></span>
<span><span class="co">## [1,] 3.990551  7.019104  9.979782</span></span>
<span><span class="co">## [2,] 3.995785  6.951943 12.961398</span></span>
<span><span class="co">## [3,] 3.997008  9.996424 13.053459</span></span>
<span><span class="co">## [4,] 6.988434 10.011049 12.945383</span></span></code></pre>
<p>On the other hand, if y were a row vector…</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">row_y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">row_y</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[1,3] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">##      [,1]         [,2]         [,3]        </span></span>
<span><span class="co">## [1,] 3.00 ± 1.00  2.02 ± 0.99  0.96 ± 0.99</span></span></code></pre>
<p>…it would have the same number of columns as <code>X</code> and
contain only one row, so it can be broadcast along rows of
<code>X</code>:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">+</span> <span class="va">row_y</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[4,3] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">##      [,1]      [,2]      [,3]     </span></span>
<span><span class="co">## [1,]  4 ± 1.4   7 ± 1.4  10 ± 1.4 </span></span>
<span><span class="co">## [2,]  5 ± 1.4   8 ± 1.4  11 ± 1.4 </span></span>
<span><span class="co">## [3,]  6 ± 1.4   9 ± 1.4  12 ± 1.4 </span></span>
<span><span class="co">## [4,]  7 ± 1.4  10 ± 1.4  13 ± 1.4</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="slicing-and-conditionals">Slicing and conditionals<a class="anchor" aria-label="anchor" href="#slicing-and-conditionals"></a>
</h2>
<p>The <code>[[</code> and <code>[</code> operators implement all of the
base array slicing operations, including numeric, character, and logical
indices, as well as slicing arrays using a matrix of indices with
<code>[</code>. The main difference between <code>rvar</code> slicing
and base array slicing is that <code>rvar</code>s default to
<code>drop = FALSE</code>; i.e. they retain all dimensions of the
original <code>rvar</code> array. For a complete list of
<code>rvar</code> slicing types, see
<code><a href="../reference/rvar-slice.html">help("rvar-slice")</a></code>.</p>
<p>In addition to the base slicing operations, <code>rvar</code> also
implements three slicing/conditioning methods that allow you to use
other <code>rvar</code>s to define a slice.</p>
<p>To demonstrate these operations, consider an <code>rvar</code> vector
of two components:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">component</span> <span class="op">=</span> <span class="fu"><a href="../reference/rvar_rng.html">rvar_rng</a></span><span class="op">(</span><span class="va">rnorm</span>, <span class="fl">2</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">component</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[2] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 1 ± 0.98  5 ± 0.99</span></span></code></pre>
<p>Perhaps we want to create a mixture of these two components,
<code>mixture</code>, with a mixing proportion of 0.75. We could create
an index, <code>i</code>, that is a random variable indicating which
component (1 or 2) determines the value of <code>mixture</code> on each
draw:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">=</span> <span class="fu"><a href="../reference/rvar_rng.html">rvar_rng</a></span><span class="op">(</span><span class="va">rbinom</span>, <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">1</span>, p <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1L</span></span>
<span><span class="va">i</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[1] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 1.7 ± 0.44</span></span></code></pre>
<p>We can use several different approaches to create the mixture
distribution</p>
<div class="section level3">
<h3 id="subsetting-rvars-by-draw-xlogical-rvar">Subsetting <code>rvar</code>s by draw:
<code>x[&lt;logical rvar&gt;]</code><a class="anchor" aria-label="anchor" href="#subsetting-rvars-by-draw-xlogical-rvar"></a>
</h3>
<p>A slice <code>x[i]</code> where <code>i</code> is a scalar logical
<code>rvar</code> returns a new rvar with the same shape as
<code>x</code>, but containing only those draws where <code>i</code> is
<code>TRUE</code>. Thus, we can use <code>i == 2</code> to select draws
from the second component and overwrite them in the first component,
creating the mixture distribution:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mixture</span> <span class="op">=</span> <span class="va">component</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">mixture</span><span class="op">[</span><span class="va">i</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="va">component</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">mixture</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[1] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 4 ± 2</span></span></code></pre>
<p>The resulting mixture looks like this:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'ggplot2' was built under R version 4.2.3</span></span></code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_slab.html" class="external-link">stat_slab</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xdist <span class="op">=</span> <span class="va">mixture</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="rvar_files/figure-html/mixture-1.png" width="700"></p>
<p>See <code><a href="http://mjskay.github.io/ggdist/articles/slabinterval.html" class="external-link">vignette("slabinterval", package = "ggdist")</a></code> for
more examples of visualizing distribution-type objects, including
<code>rvar</code>s.</p>
</div>
<div class="section level3">
<h3 id="conditionals-using-rvar_ifelse">Conditionals using <code>rvar_ifelse()</code><a class="anchor" aria-label="anchor" href="#conditionals-using-rvar_ifelse"></a>
</h3>
<p>You could create the same mixture using
<code>rvar_ifelse(test, yes, no)</code>, which broadcasts
<code>test</code>, <code>yes</code>, and <code>no</code> to the same
shape, then returns a new <code>rvar</code> containing draws from
<code>yes</code> where <code>test == TRUE</code> and draws from
<code>no</code> where <code>test == FALSE</code>.</p>
<p>Thus, we can create the mixture as follows:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/rvar_ifelse.html">rvar_ifelse</a></span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">component</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">component</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[1] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 4 ± 2</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="selecting-different-elements-in-each-draw-xnumeric-rvar">Selecting different elements in each draw:
<code>x[[&lt;numeric rvar&gt;]]</code><a class="anchor" aria-label="anchor" href="#selecting-different-elements-in-each-draw-xnumeric-rvar"></a>
</h3>
<p>The slice <code>x[[i]]</code>, where <code>i</code> is a scalar
numeric rvar, generalizes indexing when <code>i</code> is a scalar
numeric. Within each draw of <code>x</code>, it selects the element of
<code>x</code> corresponding to the value of <code>i</code> within that
same draw.</p>
<p>Thus, since <code>i</code> in our example is a scalar numeric
<code>rvar</code> whose values are either <code>1</code> or
<code>2</code> within each draw, you can use it as an index directly on
<code>component</code> to create the mixture:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="va">component</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">x</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[1] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 4 ± 2</span></span></code></pre>
<p>This approach is also nice because it generalizes easily to more than
two components.</p>
</div>
</div>
<div class="section level2">
<h2 id="applying-functions-over-rvars">Applying functions over <code>rvar</code>s<a class="anchor" aria-label="anchor" href="#applying-functions-over-rvars"></a>
</h2>
<p>The <code>rvar</code> data type supplies an implementation of
<code><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list()</a></code>, which should give compatibility with the base R
family of functions for applying functions over arrays:
<code><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply()</a></code>, <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code>, <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply()</a></code>,
<code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply()</a></code>, etc. You can also manually use
<code><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list()</a></code> to convert an <code>rvar</code> into a list along
its first dimension, which may be necessary for compatibility with some
functions (like <code>purrr:map()</code>).</p>
<p>For example, given this multidimensional <code>rvar</code>…</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3456</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rvar_rng.html">rvar_rng</a></span><span class="op">(</span><span class="va">rnorm</span>, <span class="fl">24</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[2,3,4] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## , , 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      [,1]       [,2]       [,3]      </span></span>
<span><span class="co">## [1,]  1 ± 1.00   3 ± 0.98   5 ± 1.00 </span></span>
<span><span class="co">## [2,]  2 ± 1.00   4 ± 1.00   6 ± 1.01 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      [,1]       [,2]       [,3]      </span></span>
<span><span class="co">## [1,]  7 ± 1.00   9 ± 1.00  11 ± 1.03 </span></span>
<span><span class="co">## [2,]  8 ± 0.98  10 ± 0.99  12 ± 1.00 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      [,1]       [,2]       [,3]      </span></span>
<span><span class="co">## [1,] 13 ± 1.00  15 ± 1.00  17 ± 0.99 </span></span>
<span><span class="co">## [2,] 14 ± 1.01  16 ± 1.00  18 ± 1.00 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , 4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      [,1]       [,2]       [,3]      </span></span>
<span><span class="co">## [1,] 19 ± 0.99  21 ± 0.99  23 ± 0.99 </span></span>
<span><span class="co">## [2,] 20 ± 1.00  22 ± 1.00  24 ± 1.00</span></span></code></pre>
<p>… you can apply functions along the margins using
<code><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply()</a></code> (here, a silly example):</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">length</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]    4    4    4</span></span>
<span><span class="co">## [2,]    4    4    4</span></span></code></pre>
<p>One exception is that while <code><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply()</a></code> will work with an
<code>rvar</code> input if your function returns base data types (like
numerics), it will not give you simplified <code>rvar</code> arrays if
your function returns an <code>rvar</code>. Thus, we supply the
<code><a href="../reference/rvar_apply.html">rvar_apply()</a></code> function, which takes in either base arrays or
<code>rvar</code> arrays and returns <code>rvar</code> arrays, and which
also uses the <code>rvar</code> broadcasting rules to combine the
results of the applied function.</p>
<p>For example, you can use <code><a href="../reference/rvar_apply.html">rvar_apply()</a></code> with
<code><a href="../reference/rvar-summaries-within-draws.html">rvar_mean()</a></code> to compute the distributions of means along one
margin of an array:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rvar_apply.html">rvar_apply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="va">rvar_mean</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[2] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">## [1] 12 ± 0.29  13 ± 0.29</span></span></code></pre>
<p>Or along multiple dimensions:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rvar_apply.html">rvar_apply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="va">rvar_mean</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;4000&gt;[3,4] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">##      [,1]         [,2]         [,3]         [,4]        </span></span>
<span><span class="co">## [1,]  1.5 ± 0.70   7.5 ± 0.69  13.5 ± 0.71  19.5 ± 0.70 </span></span>
<span><span class="co">## [2,]  3.5 ± 0.70   9.5 ± 0.71  15.5 ± 0.72  21.5 ± 0.70 </span></span>
<span><span class="co">## [3,]  5.5 ± 0.71  11.5 ± 0.72  17.5 ± 0.71  23.5 ± 0.70</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="looping-over-draws-and-rvars">Looping over <code>draws</code> and <code>rvar</code>s<a class="anchor" aria-label="anchor" href="#looping-over-draws-and-rvars"></a>
</h2>
<p>The <code>rvar</code> datatype is also used in
<code><a href="../reference/for_each_draw.html">for_each_draw()</a></code>, which allows you to loop over draws in a
<code>draws</code> object or an <code>rvar</code>.
<code>for_each_draw(x, expr)</code> converts <code>x</code> into a
<code><a href="../reference/draws_rvars.html">draws_rvars()</a></code> object, then loops over each draw of
<code>x</code>, executing the provided expression, <code>expr</code>.
The expression can use the variables in <code>x</code> as if they were
regular R arrays.</p>
<p>One application of <code><a href="../reference/for_each_draw.html">for_each_draw()</a></code> is in constructing
base-R plots of individual draws (for <code>ggplot2</code>-based
plotting of <code>rvar</code>s, see the next section and the <a href="https://mjskay.github.io/ggdist/" class="external-link">ggdist</a> package). For
example, it can be used to construct a parallel coordinates plot:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eight_schools</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws_rvars.html">as_draws_rvars</a></span><span class="op">(</span><span class="fu"><a href="../reference/example_draws.html">example_draws</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span>, type <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">eight_schools</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">eight_schools</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"school"</span>, ylab <span class="op">=</span> <span class="st">"theta"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use for_each_draw() to make a parallel coordinates plot of all draws</span></span>
<span><span class="co"># of eight_schools$theta</span></span>
<span><span class="fu"><a href="../reference/for_each_draw.html">for_each_draw</a></span><span class="op">(</span><span class="va">eight_schools</span>, <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, <span class="va">theta</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add means and 90% intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">eight_schools</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">eight_schools</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="../reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">eight_schools</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">eight_schools</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span>, y0 <span class="op">=</span> <span class="va">q5</span>, y1 <span class="op">=</span> <span class="va">q95</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="rvar_files/figure-html/eight_schools_parcoord-1.png" width="576"></p>
<p>As <code><a href="../reference/for_each_draw.html">for_each_draw()</a></code> will be slower than most other ways
of manipulating draws, this function should generally not be used unless
needed.</p>
</div>
<div class="section level2">
<h2 id="using-rvars-in-data-frames-and-in-ggplot2">Using <code>rvar</code>s in data frames and in ggplot2<a class="anchor" aria-label="anchor" href="#using-rvars-in-data-frames-and-in-ggplot2"></a>
</h2>
<p><code>rvar</code>s can be used as columns in
<code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code> or <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble()</a></code> objects:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>,<span class="st">"d"</span><span class="op">)</span>, <span class="va">mu</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code></pre></div>
<pre><code><span><span class="co">##   group       mu</span></span>
<span><span class="co">## 1     a 1 ± 1.02</span></span>
<span><span class="co">## 2     b 2 ± 1.02</span></span>
<span><span class="co">## 3     c 3 ± 0.99</span></span>
<span><span class="co">## 4     d 4 ± 1.01</span></span></code></pre>
<p>This makes them convenient for adding predictions to a data frame
alongside the data used to generate the predictions. <code>rvar</code>s
can then be visualized with ggplot2 by passing them to the
<code>xdist</code> and <code>ydist</code> aesthetics of the
<code>stat_...</code> family of geometries in the <a href="https://mjskay.github.io/ggdist/" class="external-link">ggdist</a> package, such as
<code><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html" class="external-link">stat_halfeye()</a></code>, <code><a href="http://mjskay.github.io/ggdist/reference/stat_lineribbon.html" class="external-link">stat_lineribbon()</a></code>, and
<code><a href="http://mjskay.github.io/ggdist/reference/stat_dotsinterval.html" class="external-link">stat_dotsinterval()</a></code>. For example:</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/" class="external-link">ggdist</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'ggdist' was built under R version 4.2.3</span></span></code></pre>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html" class="external-link">stat_halfeye</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">group</span>, xdist <span class="op">=</span> <span class="va">mu</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="rvar_files/figure-html/data_frame_plot-1.png" width="700"></p>
<p>See <code><a href="http://mjskay.github.io/ggdist/articles/slabinterval.html" class="external-link">vignette("slabinterval", package = "ggdist")</a></code> or
<code><a href="http://mjskay.github.io/tidybayes/articles/tidy-posterior.html" class="external-link">vignette("tidy-posterior", package = "tidybayes")</a></code> for more
examples.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Paul-Christian Bürkner, Jonah Gabry, Matthew Kay, Aki Vehtari.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
